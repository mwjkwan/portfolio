{"ast":null,"code":"import _regeneratorRuntime from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _defineProperty from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _taggedTemplateLiteral from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/melissa/datamatch/src/pages/PageResults/routes/RightSidebar.js\";\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  .modal-container {\\n    text-align: center;\\n    padding: 40px;\\n  }\\n\\n  .modal-question {\\n    font-size: 22px;\\n  }\\n\\n  .modal-cancel {\\n    cursor: pointer;\\n  }\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  overflow-y: scroll;\\n  position: fixed;\\n  width: 361px;\\n  height: 100vh;\\n  right: 0px;\\n  bottom: 0px;\\n  background: #f3f2f2;\\n  padding-left: 20px;\\n  padding-top: 50px;\\n\\n  @media (max-width: 650px) {\\n    height: calc(100vh - 58px);\\n  }\\n\\n  @media (max-width: 500px) {\\n    width: 100%;\\n  }\\n\\n  .heading {\\n    font-family: 'Apercu';\\n    font-size: 24px;\\n    line-height: 29px;\\n    color: #545353;\\n  }\\n\\n  .user-image {\\n    width: 80px;\\n    height: 80px;\\n    background: url(\", \");\\n    background-repeat: no-repeat;\\n    background-size: contain;\\n    background-position: center;\\n    margin-bottom: 10px;\\n    object-fit: cover;\\n  }\\n\\n  .first-image {\\n    float: left;\\n    margin-right: 10px;\\n  }\\n\\n  .description {\\n    font-size: 16px;\\n    line-height: 19px;\\n    color: #545353;\\n    margin-bottom: 10px;\\n    margin-right: 20px;\\n  }\\n\\n  .description-bold {\\n    font-family: Apercu;\\n  }\\n\\n  .submit-button {\\n    width: auto;\\n    height: 30px;\\n    padding-right: 10px;\\n    padding-left: 10px;\\n    font-family: Apercu;\\n    font-size: 14px;\\n    letter-spacing: 0.145em;\\n    text-decoration-line: underline;\\n    color: #fffbfb;\\n    margin-top: 10px;\\n  }\\n\\n  .bottom-description {\\n    margin-top: 10px;\\n    font-size: 16px;\\n    line-height: 19px;\\n    margin-right: 20px;\\n  }\\n\\n  .box-container {\\n    float: left;\\n    margin-right: 15px;\\n  }\\n\\n  .box {\\n    float: left;\\n    margin-right: 5px;\\n    margin-top: 3.5px;\\n    width: 17px;\\n    height: 17px;\\n  }\\n\\n  .box1 {\\n    background: #e9c8c5;\\n  }\\n\\n  .box2 {\\n    background: #d3908a;\\n  }\\n\\n  .box3 {\\n    background: #ffad87;\\n  }\\n\\n  .key {\\n    margin-bottom: 10px;\\n  }\\n\\n  .date {\\n    text-align: left;\\n    width: 155px;\\n    height: 32px;\\n    margin-bottom: 12px;\\n    margin-right: 12px;\\n    border: 2px solid #4f5262;\\n    font-family: Apercu;\\n    font-size: 14px;\\n    line-height: 20px;\\n    letter-spacing: 0.145em;\\n    color: #4f5262;\\n    background: #f9a9a5;\\n  }\\n\\n  .code {\\n    color: #4f5262;\\n    font-weight: bold;\\n    font-size: 1.2rem;\\n    text-decoration: underline;\\n  }\\n\\n  .cancel {\\n    text-decoration: underline;\\n    font-weight: bold;\\n    cursor: pointer;\\n  }\\n\\n  .close-button {\\n    font-size: 20px;\\n    position: absolute;\\n    top: 20px;\\n    right: 20px;\\n    cursor: pointer;\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\n/** @jsx jsx **/\nimport { Component } from 'react';\nimport { jsx, css } from '@emotion/core';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport { firebaseConnect } from 'react-redux-firebase';\nimport Modal from 'react-bootstrap/Modal';\nimport Loading from 'components/Loading';\nimport { generateCode, wait } from 'utils/helpers';\nimport Dates from './Dates';\nvar rightSidebarStyle = css(_templateObject(), require('assets/loading.svg'));\nvar rightSidebarModalStyle = css(_templateObject2());\n\nvar RightSidebar =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(RightSidebar, _Component);\n\n  function RightSidebar(props) {\n    var _this;\n\n    _classCallCheck(this, RightSidebar);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(RightSidebar).call(this, props));\n\n    _this.changeFinalized = function (finalized) {\n      var _this$props = _this.props,\n          firebase = _this$props.firebase,\n          matchId = _this$props.matchId,\n          meUser = _this$props.meUser;\n      firebase.update(\"/matches/\".concat(matchId, \"/finalized\"), _defineProperty({}, meUser.id, finalized));\n\n      _this.setState({\n        dateId: null\n      });\n    };\n\n    _this.setDateId = function (dateId) {\n      return _this.setState({\n        dateId: dateId\n      });\n    };\n\n    _this.setFilled = function (filled) {\n      return _this.setState({\n        filled: filled\n      });\n    };\n\n    _this.claimFirebase = function _callee() {\n      var dateId, _this$props2, firebase, matchId, matchedUser, meUser, dateSnapshot, datesAvailable, updates, code;\n\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              dateId = _this.state.dateId;\n              _this$props2 = _this.props, firebase = _this$props2.firebase, matchId = _this$props2.matchId, matchedUser = _this$props2.matchedUser, meUser = _this$props2.meUser;\n              _context.next = 4;\n              return _regeneratorRuntime.awrap(firebase.ref(\"dates/\".concat(dateId, \"/datesAvailable\")).once('value'));\n\n            case 4:\n              dateSnapshot = _context.sent;\n              datesAvailable = dateSnapshot.val();\n              updates = {};\n              code = generateCode();\n              updates[\"/matches/\".concat(matchId, \"/date\")] = dateId;\n              updates[\"/matches/\".concat(matchId, \"/code\")] = code;\n              updates[\"/dates/\".concat(dateId, \"/datesAvailable\")] = datesAvailable - 1;\n              updates[\"/dates/\".concat(dateId, \"/claimingMatch\")] = matchId;\n              updates[\"/codes/\".concat(code, \"/date\")] = dateId;\n              updates[\"/codes/\".concat(code, \"/match\")] = matchId;\n              _context.next = 16;\n              return _regeneratorRuntime.awrap(firebase.ref().update(updates));\n\n            case 16:\n              firebase.functions().httpsCallable('email-dateConfirmation')({\n                code: code,\n                dateId: dateId,\n                matchId: matchId,\n                meUser: meUser,\n                matchedUser: matchedUser\n              });\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      });\n    };\n\n    _this.claimDate = function _callee2() {\n      var dateId, success, i;\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              dateId = _this.state.dateId;\n\n              if (dateId) {\n                _context2.next = 3;\n                break;\n              }\n\n              return _context2.abrupt(\"return\");\n\n            case 3:\n              _this.setState({\n                claimingDate: true\n              });\n\n              success = false;\n              i = 0;\n\n            case 6:\n              if (!(i < 5)) {\n                _context2.next = 24;\n                break;\n              }\n\n              _context2.prev = 7;\n              _context2.next = 10;\n              return _regeneratorRuntime.awrap(_this.claimFirebase());\n\n            case 10:\n              success = true;\n              return _context2.abrupt(\"break\", 24);\n\n            case 14:\n              _context2.prev = 14;\n              _context2.t0 = _context2[\"catch\"](7);\n\n              if (!(_context2.t0.code !== 'PERMISSION_DENIED')) {\n                _context2.next = 19;\n                break;\n              }\n\n              alert(_context2.t0.toString());\n              return _context2.abrupt(\"break\", 24);\n\n            case 19:\n              _context2.next = 21;\n              return _regeneratorRuntime.awrap(wait(300));\n\n            case 21:\n              ++i;\n              _context2.next = 6;\n              break;\n\n            case 24:\n              if (!success) {\n                alert('Failed to redeem date. Please refresh the page and try again.');\n              } else {\n                _this.setState({\n                  dateId: null\n                });\n              }\n\n              _this.setState({\n                claimingDate: false\n              });\n\n            case 26:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, [[7, 14]]);\n    };\n\n    _this.cancelFirebase = function _callee3() {\n      var _this$props3, code, date, firebase, matchId, matchedUser, meUser, dateSnapshot, datesAvailable, updates;\n\n      return _regeneratorRuntime.async(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _this$props3 = _this.props, code = _this$props3.code, date = _this$props3.date, firebase = _this$props3.firebase, matchId = _this$props3.matchId, matchedUser = _this$props3.matchedUser, meUser = _this$props3.meUser;\n              _context3.next = 3;\n              return _regeneratorRuntime.awrap(firebase.ref(\"dates/\".concat(date, \"/datesAvailable\")).once('value'));\n\n            case 3:\n              dateSnapshot = _context3.sent;\n              datesAvailable = dateSnapshot.val();\n              updates = {};\n              updates[\"/matches/\".concat(matchId, \"/date\")] = null;\n              updates[\"/matches/\".concat(matchId, \"/code\")] = null;\n              updates[\"/dates/\".concat(date, \"/datesAvailable\")] = datesAvailable + 1;\n              updates[\"/dates/\".concat(date, \"/cancellingMatch\")] = matchId;\n              updates[\"/codes/\".concat(code, \"/date\")] = null;\n              updates[\"/codes/\".concat(code, \"/match\")] = null;\n              _context3.next = 14;\n              return _regeneratorRuntime.awrap(firebase.ref().update(updates));\n\n            case 14:\n              firebase.functions().httpsCallable('email-dateCancellation')({\n                meUser: meUser,\n                matchedUser: matchedUser,\n                matchId: matchId\n              });\n\n            case 15:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      });\n    };\n\n    _this.cancelDate = function _callee4() {\n      var _this$props4, code, date, success, i;\n\n      return _regeneratorRuntime.async(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _this$props4 = _this.props, code = _this$props4.code, date = _this$props4.date;\n\n              if (!(!date || !code)) {\n                _context4.next = 4;\n                break;\n              }\n\n              alert('Date or code not found. Cannot cancel date!');\n              return _context4.abrupt(\"return\");\n\n            case 4:\n              _this.setState({\n                cancellingDate: true,\n                show: false\n              });\n\n              success = false;\n              i = 0;\n\n            case 7:\n              if (!(i < 5)) {\n                _context4.next = 25;\n                break;\n              }\n\n              _context4.prev = 8;\n              _context4.next = 11;\n              return _regeneratorRuntime.awrap(_this.cancelFirebase());\n\n            case 11:\n              success = true;\n              return _context4.abrupt(\"break\", 25);\n\n            case 15:\n              _context4.prev = 15;\n              _context4.t0 = _context4[\"catch\"](8);\n\n              if (!(_context4.t0.code !== 'PERMISSION_DENIED')) {\n                _context4.next = 20;\n                break;\n              }\n\n              alert(_context4.t0.toString());\n              return _context4.abrupt(\"break\", 25);\n\n            case 20:\n              _context4.next = 22;\n              return _regeneratorRuntime.awrap(wait(300));\n\n            case 22:\n              ++i;\n              _context4.next = 7;\n              break;\n\n            case 25:\n              if (!success) {\n                alert('Failed to cancel date. Please refresh the page and try again.');\n              }\n\n              _this.setState({\n                cancellingDate: false\n              });\n\n            case 27:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, null, [[8, 15]]);\n    };\n\n    _this.renderHeader = function () {\n      var _this$props5 = _this.props,\n          meFinalized = _this$props5.meFinalized,\n          otherFinalized = _this$props5.otherFinalized;\n      var date = _this.state.date;\n\n      if (!meFinalized || !otherFinalized) {\n        return jsx(\"div\", {\n          className: \"heading\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 343\n          },\n          __self: this\n        }, \"SCHEDULE FREE DATE\");\n      }\n\n      if (!date) {\n        return jsx(\"div\", {\n          className: \"heading\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 347\n          },\n          __self: this\n        }, \"REDEEM YOUR DATE\");\n      }\n\n      return jsx(\"div\", {\n        className: \"heading\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 350\n        },\n        __self: this\n      }, \"YOU\\u2019RE ALL SET!\");\n    };\n\n    _this.renderDescription = function (name, otherName) {\n      var _this$props6 = _this.props,\n          meFinalized = _this$props6.meFinalized,\n          otherFinalized = _this$props6.otherFinalized;\n      var _this$state = _this.state,\n          code = _this$state.code,\n          date = _this$state.date;\n\n      if (!meFinalized) {\n        return jsx(\"div\", {\n          className: \"description\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 359\n          },\n          __self: this\n        }, \"You\\u2019re eligible to redeem a free date with your top two matches.\", jsx(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 361\n          },\n          __self: this\n        }), \" \", jsx(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 361\n          },\n          __self: this\n        }), jsx(\"span\", {\n          className: \"description-bold\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 362\n          },\n          __self: this\n        }, \"WHO: \"), otherName, \" and \", name, \" \", jsx(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 363\n          },\n          __self: this\n        }), jsx(\"span\", {\n          className: \"description-bold\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 364\n          },\n          __self: this\n        }, \"WHEN + WHERE: \"), \"Select when you're free\");\n      }\n\n      if (meFinalized && !otherFinalized) {\n        return jsx(\"div\", {\n          className: \"description\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 372\n          },\n          __self: this\n        }, jsx(\"i\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 373\n          },\n          __self: this\n        }, otherName, \" hasn't submitted availability yet.\"));\n      }\n\n      if (!date) {\n        return jsx(\"div\", {\n          className: \"description\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 380\n          },\n          __self: this\n        }, \"Once you press \\\"redeem code,\\\" you\\u2019ll get an email that you can show at the register to redeem your free date.\", jsx(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 383\n          },\n          __self: this\n        }), jsx(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 384\n          },\n          __self: this\n        }), \"Happy matching!\");\n      }\n\n      var dateInformation = _this.state.dateInformation;\n\n      if (!dateInformation) {\n        return jsx(Loading, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 392\n          },\n          __self: this\n        });\n      }\n\n      var day = dateInformation.day,\n          place = dateInformation.place;\n      return jsx(\"div\", {\n        className: \"description\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 397\n        },\n        __self: this\n      }, jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 398\n        },\n        __self: this\n      }), jsx(\"button\", {\n        className: \"date\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 399\n        },\n        __self: this\n      }, place.toUpperCase(), \" \", day), jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 402\n        },\n        __self: this\n      }), jsx(\"p\", {\n        className: \"code\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 403\n        },\n        __self: this\n      }, \"CODE: \", code));\n    };\n\n    _this.renderKey = function () {\n      var _this$props7 = _this.props,\n          matchedUser = _this$props7.matchedUser,\n          meFinalized = _this$props7.meFinalized,\n          otherFinalized = _this$props7.otherFinalized;\n\n      if (!meFinalized || !otherFinalized) {\n        return jsx(\"div\", {\n          className: \"key\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 412\n          },\n          __self: this\n        }, jsx(\"div\", {\n          className: \"box-container\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 413\n          },\n          __self: this\n        }, jsx(\"div\", {\n          className: \"box box1\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 414\n          },\n          __self: this\n        }), \" You\"), jsx(\"div\", {\n          className: \"box-container\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 416\n          },\n          __self: this\n        }, jsx(\"div\", {\n          className: \"box box2\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 417\n          },\n          __self: this\n        }), matchedUser.name.split(' ')[0]), jsx(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 420\n          },\n          __self: this\n        }, jsx(\"div\", {\n          className: \"box box3\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 421\n          },\n          __self: this\n        }), \"Both\"));\n      }\n    };\n\n    _this.confirm = function () {\n      return _this.setState({\n        show: true\n      });\n    };\n\n    _this.renderBottomElements = function () {\n      var _this$props8 = _this.props,\n          email = _this$props8.email,\n          meFinalized = _this$props8.meFinalized,\n          otherFinalized = _this$props8.otherFinalized;\n      var _this$state2 = _this.state,\n          claimingDate = _this$state2.claimingDate,\n          cancellingDate = _this$state2.cancellingDate,\n          date = _this$state2.date,\n          dateId = _this$state2.dateId,\n          filled = _this$state2.filled;\n\n      if (!meFinalized) {\n        return jsx(\"div\", {\n          className: \"description\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 437\n          },\n          __self: this\n        }, jsx(\"button\", {\n          className: \"submit-button\",\n          onClick: function onClick() {\n            return filled ? _this.changeFinalized(true) : null;\n          },\n          style: {\n            background: filled ? '#bd574e' : '#6e6973'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 438\n          },\n          __self: this\n        }, \"SUBMIT AVAILABILITY\"), jsx(\"div\", {\n          className: \"bottom-description\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 445\n          },\n          __self: this\n        }, \"Once you both submit, you\\u2019ll be able to redeem a code for a time you can both make!\"));\n      }\n\n      if (meFinalized && !otherFinalized) {\n        return null;\n      }\n\n      if (!date) {\n        return claimingDate ? jsx(Loading, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 459\n          },\n          __self: this\n        }) : jsx(\"div\", {\n          className: \"bottom-description\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 461\n          },\n          __self: this\n        }, jsx(\"button\", {\n          className: \"submit-button\",\n          onClick: _this.claimDate,\n          style: {\n            background: dateId ? '#bd574e' : '#6e6973'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 462\n          },\n          __self: this\n        }, \"REDEEM CODE\"), jsx(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 469\n          },\n          __self: this\n        }), jsx(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 470\n          },\n          __self: this\n        }), jsx(\"div\", {\n          className: \"cancel\",\n          onClick: function onClick() {\n            return _this.changeFinalized(false);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 471\n          },\n          __self: this\n        }, \"Change your availability\"), jsx(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 474\n          },\n          __self: this\n        }), \"(Codes must be redeemed online here before\", ' ', jsx(\"b\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 476\n          },\n          __self: this\n        }, jsx(\"u\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 477\n          },\n          __self: this\n        }, \"5am\")), ' ', \"the day of the actual date.)\");\n      }\n\n      var dateInformation = _this.state.dateInformation;\n\n      if (!dateInformation) {\n        return jsx(Loading, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 486\n          },\n          __self: this\n        });\n      }\n\n      var now = new Date().getTime();\n      var unix = dateInformation.unix;\n      return jsx(\"div\", {\n        className: \"bottom-description\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 492\n        },\n        __self: this\n      }, \"Your verification code has also been sent to \", email, \".\", jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 494\n        },\n        __self: this\n      }), jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 495\n        },\n        __self: this\n      }), \"Present your code at the cashier to redeem your date. Dates can be cancelled anytime before\", ' ', jsx(\"b\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 498\n        },\n        __self: this\n      }, jsx(\"u\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 499\n        },\n        __self: this\n      }, \"5am\")), ' ', \"the day of the actual date.\", jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 502\n        },\n        __self: this\n      }), jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 503\n        },\n        __self: this\n      }), cancellingDate ? jsx(Loading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 505\n        },\n        __self: this\n      }) : now < unix ? jsx(\"div\", {\n        className: \"cancel\",\n        onClick: _this.confirm,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 507\n        },\n        __self: this\n      }, \"Cancel date\") : null);\n    };\n\n    _this.state = {\n      cancellingDate: false,\n      claimingDate: false,\n      filled: false,\n      show: false\n    };\n    return _this;\n  }\n\n  _createClass(RightSidebar, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      var _this$props9, code, date, firebase, requested, _this$state3, cancellingDate, claimingDate, dateSnapshot, dateInformation;\n\n      return _regeneratorRuntime.async(function componentDidUpdate$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _this$props9 = this.props, code = _this$props9.code, date = _this$props9.date, firebase = _this$props9.firebase, requested = _this$props9.requested;\n              _this$state3 = this.state, cancellingDate = _this$state3.cancellingDate, claimingDate = _this$state3.claimingDate;\n\n              if (!(claimingDate || cancellingDate)) {\n                _context5.next = 4;\n                break;\n              }\n\n              return _context5.abrupt(\"return\");\n\n            case 4:\n              if (requested) {\n                _context5.next = 6;\n                break;\n              }\n\n              return _context5.abrupt(\"return\");\n\n            case 6:\n              if (!(date !== this.state.date)) {\n                _context5.next = 16;\n                break;\n              }\n\n              if (!date) {\n                _context5.next = 15;\n                break;\n              }\n\n              _context5.next = 10;\n              return _regeneratorRuntime.awrap(firebase.ref(\"/dates/\".concat(date)).once('value'));\n\n            case 10:\n              dateSnapshot = _context5.sent;\n              dateInformation = dateSnapshot.val();\n              this.setState({\n                date: date,\n                dateInformation: dateInformation\n              });\n              _context5.next = 16;\n              break;\n\n            case 15:\n              this.setState({\n                date: date\n              });\n\n            case 16:\n              if (code !== this.state.code) {\n                this.setState({\n                  code: code\n                });\n              }\n\n            case 17:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, null, this);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props10 = this.props,\n          close = _this$props10.close,\n          involvedSchools = _this$props10.involvedSchools,\n          matchedUser = _this$props10.matchedUser,\n          matchId = _this$props10.matchId,\n          meFinalized = _this$props10.meFinalized,\n          meUser = _this$props10.meUser,\n          otherFinalized = _this$props10.otherFinalized,\n          requested = _this$props10.requested;\n      var otherUid = matchedUser.id;\n      var _this$state4 = this.state,\n          claimingDate = _this$state4.claimingDate,\n          date = _this$state4.date,\n          dateId = _this$state4.dateId,\n          show = _this$state4.show;\n\n      if (!requested) {\n        return jsx(\"div\", {\n          css: rightSidebarStyle,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 531\n          },\n          __self: this\n        }, jsx(Loading, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 532\n          },\n          __self: this\n        }));\n      }\n\n      return jsx(\"div\", {\n        css: rightSidebarStyle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 538\n        },\n        __self: this\n      }, jsx(\"i\", {\n        className: \"fas fa-times close-button\",\n        onClick: close,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 539\n        },\n        __self: this\n      }), jsx(\"img\", {\n        alt: \"profile\",\n        className: \"user-image first-image\",\n        src: matchedUser.profile_pic || require('assets/empty.png'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 540\n        },\n        __self: this\n      }), jsx(\"img\", {\n        alt: \"profile\",\n        className: \"user-image\",\n        src: meUser.profile_pic || require('assets/empty.png'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 545\n        },\n        __self: this\n      }), this.renderHeader(), this.renderDescription(meUser.name, matchedUser.name), this.renderKey(), !date && jsx(Dates, {\n        claimingDate: claimingDate,\n        involvedSchools: involvedSchools,\n        dateId: dateId,\n        matchId: matchId,\n        meFinalized: meFinalized,\n        otherFinalized: otherFinalized,\n        otherUid: otherUid,\n        setDateId: this.setDateId,\n        setFilled: this.setFilled,\n        uid: meUser.id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 556\n        },\n        __self: this\n      }), this.renderBottomElements(), jsx(Modal, {\n        css: rightSidebarModalStyle,\n        onHide: function onHide() {\n          return _this2.setState({\n            show: false\n          });\n        },\n        show: show,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 572\n        },\n        __self: this\n      }, jsx(Modal.Body, {\n        className: \"modal-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 577\n        },\n        __self: this\n      }, jsx(\"div\", {\n        className: \"modal-question\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 578\n        },\n        __self: this\n      }, \"Are you sure you want to cancel your date? You will lose your spot, and you and your match will both receive a cancellation email. You will be able to reschedule.\"), jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 583\n        },\n        __self: this\n      }), jsx(\"button\", {\n        onClick: this.cancelDate,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 584\n        },\n        __self: this\n      }, \"Yes, cancel\"), jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 585\n        },\n        __self: this\n      }), jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 586\n        },\n        __self: this\n      }), jsx(\"div\", {\n        className: \"modal-cancel\",\n        onClick: function onClick() {\n          return _this2.setState({\n            show: false\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 587\n        },\n        __self: this\n      }, \"Just kidding!\"))));\n    }\n  }]);\n\n  return RightSidebar;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state, props) {\n  var _state$firebase$data = state.firebase.data,\n      code = _state$firebase$data.code,\n      date = _state$firebase$data.date,\n      finalized = _state$firebase$data.finalized;\n  var _state$firebase = state.firebase,\n      auth = _state$firebase.auth,\n      requested = _state$firebase.requested;\n  var matchedUser = props.matchedUser,\n      meUser = props.meUser;\n  return {\n    code: code,\n    date: date,\n    email: auth.email,\n    finalized: finalized,\n    meFinalized: (finalized || {})[meUser.id],\n    otherFinalized: (finalized || {})[matchedUser.id],\n    requested: requested.code && requested.date && requested.finalized\n  };\n};\n\nexport default compose(firebaseConnect(function (_ref) {\n  var matchId = _ref.matchId;\n  return [{\n    path: \"/matches/\".concat(matchId, \"/code\"),\n    storeAs: 'code'\n  }, {\n    path: \"/matches/\".concat(matchId, \"/date\"),\n    storeAs: 'date'\n  }, {\n    path: \"/matches/\".concat(matchId, \"/finalized\"),\n    storeAs: 'finalized'\n  }];\n}), connect(mapStateToProps))(RightSidebar);","map":{"version":3,"sources":["/Users/melissa/datamatch/src/pages/PageResults/routes/RightSidebar.js"],"names":["Component","jsx","css","connect","compose","firebaseConnect","Modal","Loading","generateCode","wait","Dates","rightSidebarStyle","require","rightSidebarModalStyle","RightSidebar","props","changeFinalized","finalized","firebase","matchId","meUser","update","id","setState","dateId","setDateId","setFilled","filled","claimFirebase","state","matchedUser","ref","once","dateSnapshot","datesAvailable","val","updates","code","functions","httpsCallable","claimDate","claimingDate","success","i","alert","toString","cancelFirebase","date","cancelDate","cancellingDate","show","renderHeader","meFinalized","otherFinalized","renderDescription","name","otherName","dateInformation","day","place","toUpperCase","renderKey","split","confirm","renderBottomElements","email","background","now","Date","getTime","unix","requested","close","involvedSchools","otherUid","profile_pic","mapStateToProps","data","auth","path","storeAs"],"mappings":"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","sourcesContent":["/** @jsx jsx **/\n\nimport { Component } from 'react';\nimport { jsx, css } from '@emotion/core';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport { firebaseConnect } from 'react-redux-firebase';\nimport Modal from 'react-bootstrap/Modal';\n\nimport Loading from 'components/Loading';\nimport { generateCode, wait } from 'utils/helpers';\nimport Dates from './Dates';\n\nconst rightSidebarStyle = css`\n  overflow-y: scroll;\n  position: fixed;\n  width: 361px;\n  height: 100vh;\n  right: 0px;\n  bottom: 0px;\n  background: #f3f2f2;\n  padding-left: 20px;\n  padding-top: 50px;\n\n  @media (max-width: 650px) {\n    height: calc(100vh - 58px);\n  }\n\n  @media (max-width: 500px) {\n    width: 100%;\n  }\n\n  .heading {\n    font-family: 'Apercu';\n    font-size: 24px;\n    line-height: 29px;\n    color: #545353;\n  }\n\n  .user-image {\n    width: 80px;\n    height: 80px;\n    background: url(${require('assets/loading.svg')});\n    background-repeat: no-repeat;\n    background-size: contain;\n    background-position: center;\n    margin-bottom: 10px;\n    object-fit: cover;\n  }\n\n  .first-image {\n    float: left;\n    margin-right: 10px;\n  }\n\n  .description {\n    font-size: 16px;\n    line-height: 19px;\n    color: #545353;\n    margin-bottom: 10px;\n    margin-right: 20px;\n  }\n\n  .description-bold {\n    font-family: Apercu;\n  }\n\n  .submit-button {\n    width: auto;\n    height: 30px;\n    padding-right: 10px;\n    padding-left: 10px;\n    font-family: Apercu;\n    font-size: 14px;\n    letter-spacing: 0.145em;\n    text-decoration-line: underline;\n    color: #fffbfb;\n    margin-top: 10px;\n  }\n\n  .bottom-description {\n    margin-top: 10px;\n    font-size: 16px;\n    line-height: 19px;\n    margin-right: 20px;\n  }\n\n  .box-container {\n    float: left;\n    margin-right: 15px;\n  }\n\n  .box {\n    float: left;\n    margin-right: 5px;\n    margin-top: 3.5px;\n    width: 17px;\n    height: 17px;\n  }\n\n  .box1 {\n    background: #e9c8c5;\n  }\n\n  .box2 {\n    background: #d3908a;\n  }\n\n  .box3 {\n    background: #ffad87;\n  }\n\n  .key {\n    margin-bottom: 10px;\n  }\n\n  .date {\n    text-align: left;\n    width: 155px;\n    height: 32px;\n    margin-bottom: 12px;\n    margin-right: 12px;\n    border: 2px solid #4f5262;\n    font-family: Apercu;\n    font-size: 14px;\n    line-height: 20px;\n    letter-spacing: 0.145em;\n    color: #4f5262;\n    background: #f9a9a5;\n  }\n\n  .code {\n    color: #4f5262;\n    font-weight: bold;\n    font-size: 1.2rem;\n    text-decoration: underline;\n  }\n\n  .cancel {\n    text-decoration: underline;\n    font-weight: bold;\n    cursor: pointer;\n  }\n\n  .close-button {\n    font-size: 20px;\n    position: absolute;\n    top: 20px;\n    right: 20px;\n    cursor: pointer;\n  }\n`;\n\nconst rightSidebarModalStyle = css`\n  .modal-container {\n    text-align: center;\n    padding: 40px;\n  }\n\n  .modal-question {\n    font-size: 22px;\n  }\n\n  .modal-cancel {\n    cursor: pointer;\n  }\n`;\n\nclass RightSidebar extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      cancellingDate: false,\n      claimingDate: false,\n      filled: false,\n      show: false,\n    };\n  }\n\n  async componentDidUpdate() {\n    const { code, date, firebase, requested } = this.props;\n    const { cancellingDate, claimingDate } = this.state;\n\n    if (claimingDate || cancellingDate) {\n      return;\n    }\n\n    if (!requested) {\n      return;\n    }\n\n    if (date !== this.state.date) {\n      if (date) {\n        const dateSnapshot = await firebase.ref(`/dates/${date}`).once('value');\n        const dateInformation = dateSnapshot.val();\n        this.setState({ date, dateInformation });\n      } else {\n        this.setState({ date });\n      }\n    }\n\n    if (code !== this.state.code) {\n      this.setState({ code });\n    }\n  }\n\n  changeFinalized = finalized => {\n    const { firebase, matchId, meUser } = this.props;\n    firebase.update(`/matches/${matchId}/finalized`, {\n      [meUser.id]: finalized,\n    });\n    this.setState({ dateId: null });\n  };\n\n  setDateId = dateId => this.setState({ dateId });\n\n  setFilled = filled => this.setState({ filled });\n\n  claimFirebase = async () => {\n    const { dateId } = this.state;\n    const { firebase, matchId, matchedUser, meUser } = this.props;\n\n    const dateSnapshot = await firebase\n      .ref(`dates/${dateId}/datesAvailable`)\n      .once('value');\n    const datesAvailable = dateSnapshot.val();\n\n    let updates = {};\n    const code = generateCode();\n    updates[`/matches/${matchId}/date`] = dateId;\n    updates[`/matches/${matchId}/code`] = code;\n    updates[`/dates/${dateId}/datesAvailable`] = datesAvailable - 1;\n    updates[`/dates/${dateId}/claimingMatch`] = matchId;\n    updates[`/codes/${code}/date`] = dateId;\n    updates[`/codes/${code}/match`] = matchId;\n\n    await firebase.ref().update(updates);\n    firebase.functions().httpsCallable('email-dateConfirmation')({\n      code,\n      dateId,\n      matchId,\n      meUser,\n      matchedUser,\n    });\n  };\n\n  claimDate = async () => {\n    const { dateId } = this.state;\n\n    if (!dateId) {\n      return;\n    }\n\n    this.setState({ claimingDate: true });\n\n    let success = false;\n    for (let i = 0; i < 5; ++i) {\n      try {\n        await this.claimFirebase();\n        success = true;\n        break;\n      } catch (e) {\n        if (e.code !== 'PERMISSION_DENIED') {\n          alert(e.toString());\n          break;\n        }\n      }\n\n      await wait(300);\n    }\n\n    if (!success) {\n      alert('Failed to redeem date. Please refresh the page and try again.');\n    } else {\n      this.setState({ dateId: null });\n    }\n\n    this.setState({ claimingDate: false });\n  };\n\n  cancelFirebase = async () => {\n    const { code, date, firebase, matchId, matchedUser, meUser } = this.props;\n\n    const dateSnapshot = await firebase\n      .ref(`dates/${date}/datesAvailable`)\n      .once('value');\n    const datesAvailable = dateSnapshot.val();\n\n    let updates = {};\n    updates[`/matches/${matchId}/date`] = null;\n    updates[`/matches/${matchId}/code`] = null;\n    updates[`/dates/${date}/datesAvailable`] = datesAvailable + 1;\n    updates[`/dates/${date}/cancellingMatch`] = matchId;\n    updates[`/codes/${code}/date`] = null;\n    updates[`/codes/${code}/match`] = null;\n\n    await firebase.ref().update(updates);\n    firebase.functions().httpsCallable('email-dateCancellation')({\n      meUser,\n      matchedUser,\n      matchId,\n    });\n  };\n\n  cancelDate = async () => {\n    const { code, date } = this.props;\n\n    if (!date || !code) {\n      alert('Date or code not found. Cannot cancel date!');\n      return;\n    }\n\n    this.setState({ cancellingDate: true, show: false });\n\n    let success = false;\n    for (let i = 0; i < 5; ++i) {\n      try {\n        await this.cancelFirebase();\n        success = true;\n        break;\n      } catch (e) {\n        if (e.code !== 'PERMISSION_DENIED') {\n          alert(e.toString());\n          break;\n        }\n      }\n\n      await wait(300);\n    }\n\n    if (!success) {\n      alert('Failed to cancel date. Please refresh the page and try again.');\n    }\n\n    this.setState({ cancellingDate: false });\n  };\n\n  renderHeader = () => {\n    const { meFinalized, otherFinalized } = this.props;\n    const { date } = this.state;\n\n    if (!meFinalized || !otherFinalized) {\n      return <div className=\"heading\">SCHEDULE FREE DATE</div>;\n    }\n\n    if (!date) {\n      return <div className=\"heading\">REDEEM YOUR DATE</div>;\n    }\n\n    return <div className=\"heading\">YOU’RE ALL SET!</div>;\n  };\n\n  renderDescription = (name, otherName) => {\n    const { meFinalized, otherFinalized } = this.props;\n    const { code, date } = this.state;\n\n    if (!meFinalized) {\n      return (\n        <div className=\"description\">\n          You’re eligible to redeem a free date with your top two matches.\n          <br /> <br />\n          <span className=\"description-bold\">WHO: </span>\n          {otherName} and {name} <br></br>\n          <span className=\"description-bold\">WHEN + WHERE: </span>Select when\n          you're free\n        </div>\n      );\n    }\n\n    if (meFinalized && !otherFinalized) {\n      return (\n        <div className=\"description\">\n          <i>{otherName} hasn't submitted availability yet.</i>\n        </div>\n      );\n    }\n\n    if (!date) {\n      return (\n        <div className=\"description\">\n          Once you press \"redeem code,\" you’ll get an email that you can show at\n          the register to redeem your free date.\n          <br />\n          <br />\n          Happy matching!\n        </div>\n      );\n    }\n\n    const { dateInformation } = this.state;\n    if (!dateInformation) {\n      return <Loading />;\n    }\n    const { day, place } = dateInformation;\n\n    return (\n      <div className=\"description\">\n        <br />\n        <button className=\"date\">\n          {place.toUpperCase()} {day}\n        </button>\n        <br />\n        <p className=\"code\">CODE: {code}</p>\n      </div>\n    );\n  };\n\n  renderKey = () => {\n    const { matchedUser, meFinalized, otherFinalized } = this.props;\n    if (!meFinalized || !otherFinalized) {\n      return (\n        <div className=\"key\">\n          <div className=\"box-container\">\n            <div className=\"box box1\" /> You\n          </div>\n          <div className=\"box-container\">\n            <div className=\"box box2\" />\n            {matchedUser.name.split(' ')[0]}\n          </div>\n          <div>\n            <div className=\"box box3\" />\n            Both\n          </div>\n        </div>\n      );\n    }\n  };\n\n  confirm = () => this.setState({ show: true });\n\n  renderBottomElements = () => {\n    const { email, meFinalized, otherFinalized } = this.props;\n    const { claimingDate, cancellingDate, date, dateId, filled } = this.state;\n\n    if (!meFinalized) {\n      return (\n        <div className=\"description\">\n          <button\n            className=\"submit-button\"\n            onClick={() => (filled ? this.changeFinalized(true) : null)}\n            style={{ background: filled ? '#bd574e' : '#6e6973' }}\n          >\n            SUBMIT AVAILABILITY\n          </button>\n          <div className=\"bottom-description\">\n            Once you both submit, you’ll be able to redeem a code for a time you\n            can both make!\n          </div>\n        </div>\n      );\n    }\n\n    if (meFinalized && !otherFinalized) {\n      return null;\n    }\n\n    if (!date) {\n      return claimingDate ? (\n        <Loading />\n      ) : (\n        <div className=\"bottom-description\">\n          <button\n            className=\"submit-button\"\n            onClick={this.claimDate}\n            style={{ background: dateId ? '#bd574e' : '#6e6973' }}\n          >\n            REDEEM CODE\n          </button>\n          <br />\n          <br />\n          <div className=\"cancel\" onClick={() => this.changeFinalized(false)}>\n            Change your availability\n          </div>\n          <br />\n          (Codes must be redeemed online here before{' '}\n          <b>\n            <u>5am</u>\n          </b>{' '}\n          the day of the actual date.)\n        </div>\n      );\n    }\n\n    const { dateInformation } = this.state;\n    if (!dateInformation) {\n      return <Loading />;\n    }\n    const now = new Date().getTime();\n    const { unix } = dateInformation;\n\n    return (\n      <div className=\"bottom-description\">\n        Your verification code has also been sent to {email}.\n        <br />\n        <br />\n        Present your code at the cashier to redeem your date. Dates can be\n        cancelled anytime before{' '}\n        <b>\n          <u>5am</u>\n        </b>{' '}\n        the day of the actual date.\n        <br />\n        <br />\n        {cancellingDate ? (\n          <Loading />\n        ) : now < unix ? (\n          <div className=\"cancel\" onClick={this.confirm}>\n            Cancel date\n          </div>\n        ) : null}\n      </div>\n    );\n  };\n\n  render() {\n    const {\n      close,\n      involvedSchools,\n      matchedUser,\n      matchId,\n      meFinalized,\n      meUser,\n      otherFinalized,\n      requested,\n    } = this.props;\n    const otherUid = matchedUser.id;\n    const { claimingDate, date, dateId, show } = this.state;\n\n    if (!requested) {\n      return (\n        <div css={rightSidebarStyle}>\n          <Loading />\n        </div>\n      );\n    }\n\n    return (\n      <div css={rightSidebarStyle}>\n        <i className=\"fas fa-times close-button\" onClick={close} />\n        <img\n          alt=\"profile\"\n          className=\"user-image first-image\"\n          src={matchedUser.profile_pic || require('assets/empty.png')}\n        />\n        <img\n          alt=\"profile\"\n          className=\"user-image\"\n          src={meUser.profile_pic || require('assets/empty.png')}\n        />\n\n        {this.renderHeader()}\n        {this.renderDescription(meUser.name, matchedUser.name)}\n        {this.renderKey()}\n\n        {!date && (\n          <Dates\n            claimingDate={claimingDate}\n            involvedSchools={involvedSchools}\n            dateId={dateId}\n            matchId={matchId}\n            meFinalized={meFinalized}\n            otherFinalized={otherFinalized}\n            otherUid={otherUid}\n            setDateId={this.setDateId}\n            setFilled={this.setFilled}\n            uid={meUser.id}\n          />\n        )}\n\n        {this.renderBottomElements()}\n\n        <Modal\n          css={rightSidebarModalStyle}\n          onHide={() => this.setState({ show: false })}\n          show={show}\n        >\n          <Modal.Body className=\"modal-container\">\n            <div className=\"modal-question\">\n              Are you sure you want to cancel your date? You will lose your\n              spot, and you and your match will both receive a cancellation\n              email. You will be able to reschedule.\n            </div>\n            <br />\n            <button onClick={this.cancelDate}>Yes, cancel</button>\n            <br />\n            <br />\n            <div\n              className=\"modal-cancel\"\n              onClick={() => this.setState({ show: false })}\n            >\n              Just kidding!\n            </div>\n          </Modal.Body>\n        </Modal>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  const { code, date, finalized } = state.firebase.data;\n  const { auth, requested } = state.firebase;\n  const { matchedUser, meUser } = props;\n\n  return {\n    code,\n    date,\n    email: auth.email,\n    finalized,\n    meFinalized: (finalized || {})[meUser.id],\n    otherFinalized: (finalized || {})[matchedUser.id],\n    requested: requested.code && requested.date && requested.finalized,\n  };\n};\n\nexport default compose(\n  firebaseConnect(({ matchId }) => [\n    {\n      path: `/matches/${matchId}/code`,\n      storeAs: 'code',\n    },\n    {\n      path: `/matches/${matchId}/date`,\n      storeAs: 'date',\n    },\n    {\n      path: `/matches/${matchId}/finalized`,\n      storeAs: 'finalized',\n    },\n  ]),\n  connect(mapStateToProps),\n)(RightSidebar);\n"]},"metadata":{},"sourceType":"module"}