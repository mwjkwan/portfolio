{"ast":null,"code":"import _regeneratorRuntime from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _classCallCheck from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/melissa/datamatch/src/pages/RestaurantPortal/App.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport { firebaseConnect } from 'react-redux-firebase';\nimport { Route, Switch, Redirect } from 'react-router-dom';\nimport Sidebar from 'components/Sidebar';\nimport Loading from 'components/Loading';\nimport CheckIn from './CheckIn';\nimport ConfirmationCodes from './ConfirmationCodes';\nimport Home from './Home';\nimport NavigationBar from './NavigationBar';\n\nvar PageApp =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(PageApp, _Component);\n\n  function PageApp(props) {\n    var _this;\n\n    _classCallCheck(this, PageApp);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(PageApp).call(this, props));\n    _this.state = {\n      loading: true,\n      restaurant: props.profile.restaurantAdmin\n    };\n    return _this;\n  }\n\n  _createClass(PageApp, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props, firebase, isLoggedIn, profile, restaurant, _ref, data, restaurantInformation, snapshot;\n\n      return _regeneratorRuntime.async(function componentDidMount$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this$props = this.props, firebase = _this$props.firebase, isLoggedIn = _this$props.isLoggedIn, profile = _this$props.profile;\n              restaurant = profile.restaurantAdmin; // if we aren't 100% sure this person is a restaurantAdmin\n\n              if (!(isLoggedIn && !restaurant)) {\n                _context.next = 8;\n                break;\n              }\n\n              _context.next = 5;\n              return _regeneratorRuntime.awrap(firebase.functions().httpsCallable('user-makeRestaurantAdmin')());\n\n            case 5:\n              _ref = _context.sent;\n              data = _ref.data;\n              restaurant = data;\n\n            case 8:\n              restaurantInformation = null;\n\n              if (!restaurant) {\n                _context.next = 14;\n                break;\n              }\n\n              _context.next = 12;\n              return _regeneratorRuntime.awrap(firebase.ref(\"/restaurants/\".concat(restaurant)).once('value'));\n\n            case 12:\n              snapshot = _context.sent;\n              restaurantInformation = snapshot.val();\n\n            case 14:\n              this.setState({\n                loading: false,\n                restaurant: restaurant,\n                restaurantInformation: restaurantInformation\n              });\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, this);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      if (this.state.loading) {\n        return React.createElement(\"div\", {\n          style: {\n            margin: '10% auto'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 50\n          },\n          __self: this\n        }, React.createElement(Loading, {\n          size: 200,\n          type: \"spin\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 51\n          },\n          __self: this\n        }));\n      }\n\n      var _this$state = this.state,\n          restaurant = _this$state.restaurant,\n          restaurantInformation = _this$state.restaurantInformation;\n      var prefix = '/restaurant';\n\n      if (!this.props.isLoggedIn) {\n        return React.createElement(Redirect, {\n          to: \"\".concat(prefix, \"/login\"),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 60\n          },\n          __self: this\n        });\n      }\n\n      if (!restaurant) {\n        return React.createElement(Redirect, {\n          to: \"/\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 64\n          },\n          __self: this\n        });\n      }\n\n      return React.createElement(\"div\", {\n        className: \"PageRestaurant\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68\n        },\n        __self: this\n      }, React.createElement(Sidebar, {\n        leftSidebar: React.createElement(NavigationBar, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 69\n          },\n          __self: this\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }, React.createElement(Switch, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      }, React.createElement(Route, {\n        exact: true,\n        path: prefix,\n        render: function render() {\n          return React.createElement(Home, Object.assign({\n            restaurantInformation: restaurantInformation\n          }, _this2.props, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 75\n            },\n            __self: this\n          }));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      }), React.createElement(Route, {\n        exact: true,\n        path: \"\".concat(prefix, \"/check-in\"),\n        render: function render() {\n          return React.createElement(CheckIn, Object.assign({\n            restaurant: restaurant,\n            restaurantInformation: restaurantInformation\n          }, _this2.props, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 85\n            },\n            __self: this\n          }));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81\n        },\n        __self: this\n      }), React.createElement(Route, {\n        exact: true,\n        path: \"\".concat(prefix, \"/confirmation-codes\"),\n        render: function render() {\n          return React.createElement(ConfirmationCodes, Object.assign({\n            restaurantInformation: restaurantInformation\n          }, _this2.props, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 96\n            },\n            __self: this\n          }));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92\n        },\n        __self: this\n      }))));\n    }\n  }]);\n\n  return PageApp;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    isLoggedIn: !!state.firebase.auth.uid,\n    profile: state.firebase.profile\n  };\n};\n\nexport default compose(firebaseConnect(), connect(mapStateToProps))(PageApp);","map":{"version":3,"sources":["/Users/melissa/datamatch/src/pages/RestaurantPortal/App.js"],"names":["React","Component","connect","compose","firebaseConnect","Route","Switch","Redirect","Sidebar","Loading","CheckIn","ConfirmationCodes","Home","NavigationBar","PageApp","props","state","loading","restaurant","profile","restaurantAdmin","firebase","isLoggedIn","functions","httpsCallable","data","restaurantInformation","ref","once","snapshot","val","setState","margin","prefix","mapStateToProps","auth","uid"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport { firebaseConnect } from 'react-redux-firebase';\nimport { Route, Switch, Redirect } from 'react-router-dom';\n\nimport Sidebar from 'components/Sidebar';\nimport Loading from 'components/Loading';\n\nimport CheckIn from './CheckIn';\nimport ConfirmationCodes from './ConfirmationCodes';\nimport Home from './Home';\nimport NavigationBar from './NavigationBar';\n\nclass PageApp extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      restaurant: props.profile.restaurantAdmin,\n    };\n  }\n\n  async componentDidMount() {\n    const { firebase, isLoggedIn, profile } = this.props;\n    let restaurant = profile.restaurantAdmin;\n\n    // if we aren't 100% sure this person is a restaurantAdmin\n    if (isLoggedIn && !restaurant) {\n      const { data } = await firebase\n        .functions()\n        .httpsCallable('user-makeRestaurantAdmin')();\n      restaurant = data;\n    }\n\n    let restaurantInformation = null;\n    if (restaurant) {\n      const snapshot = await firebase\n        .ref(`/restaurants/${restaurant}`)\n        .once('value');\n      restaurantInformation = snapshot.val();\n    }\n\n    this.setState({ loading: false, restaurant, restaurantInformation });\n  }\n\n  render() {\n    if (this.state.loading) {\n      return (\n        <div style={{ margin: '10% auto' }}>\n          <Loading size={200} type=\"spin\" />\n        </div>\n      );\n    }\n\n    const { restaurant, restaurantInformation } = this.state;\n    const prefix = '/restaurant';\n\n    if (!this.props.isLoggedIn) {\n      return <Redirect to={`${prefix}/login`} />;\n    }\n\n    if (!restaurant) {\n      return <Redirect to=\"/\" />;\n    }\n\n    return (\n      <div className=\"PageRestaurant\">\n        <Sidebar leftSidebar={<NavigationBar />}>\n          <Switch>\n            <Route\n              exact\n              path={prefix}\n              render={() => (\n                <Home\n                  restaurantInformation={restaurantInformation}\n                  {...this.props}\n                />\n              )}\n            />\n            <Route\n              exact\n              path={`${prefix}/check-in`}\n              render={() => (\n                <CheckIn\n                  restaurant={restaurant}\n                  restaurantInformation={restaurantInformation}\n                  {...this.props}\n                />\n              )}\n            />\n            <Route\n              exact\n              path={`${prefix}/confirmation-codes`}\n              render={() => (\n                <ConfirmationCodes\n                  restaurantInformation={restaurantInformation}\n                  {...this.props}\n                />\n              )}\n            />\n          </Switch>\n        </Sidebar>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    isLoggedIn: !!state.firebase.auth.uid,\n    profile: state.firebase.profile,\n  };\n};\n\nexport default compose(firebaseConnect(), connect(mapStateToProps))(PageApp);\n"]},"metadata":{},"sourceType":"module"}