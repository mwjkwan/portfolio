{"ast":null,"code":"import _objectSpread from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _defineProperty from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _taggedTemplateLiteral from \"/Users/melissa/datamatch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/melissa/datamatch/src/pages/SchoolPortal/Profile.js\";\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  p {\\n    font-size: 18px;\\n    font-family: Apercu;\\n    font-weight: 500;\\n    line-height: 22px;\\n    letter-spacing: 0.05em;\\n  }\\n\\n  .nodescription {\\n    margin-bottom: 10px;\\n  }\\n\\n  .description {\\n    font-size: 16px;\\n    font-family: Apercu-light;\\n    margin-bottom: 10px;\\n  }\\n\\n  .inputcontainer {\\n    display: table;\\n  }\\n\\n  .input {\\n    width: 300px;\\n    height: 40px;\\n    background: #f4f2f2;\\n    border: 0px;\\n    margin-bottom: 5px;\\n    margin-right: 10px;\\n  }\\n\\n  .buttonsymbol {\\n    line-height: 29px;\\n  }\\n\\n  .roundbutton {\\n    height: 35px;\\n    width: 35px;\\n    border: 3px solid #bd574e;\\n    border-radius: 50%;\\n    display: inline-block;\\n    background: rgba(249, 198, 195, 0.8);\\n    color: #bd574e;\\n    text-align: center;\\n    vertical-align: middle;\\n    cursor: pointer;\\n  }\\n\\n  .savechanges {\\n    background: #bd574e;\\n    color: #ffffff;\\n    font-family: Apercu;\\n    font-size: 18px;\\n    width: 170px;\\n    height: 38px;\\n    letter-spacing: 0.05em;\\n    align-items: center;\\n    margin-top: 20px;\\n  }\\n\\n  .checkmark {\\n    margin-right: 4px;\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\n/** @jsx jsx */\nimport { Component } from 'react';\nimport { jsx, css } from '@emotion/core';\nimport Header from 'components/Header';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport { firestoreConnect, firebaseConnect, isLoaded } from 'react-redux-firebase';\nimport Input from 'components/Input';\nimport Loading from 'components/Loading';\nimport InputList from './InputList';\nvar profileStyle = css(_templateObject());\n\nvar Profile =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Profile, _Component);\n\n  function Profile(props) {\n    var _this;\n\n    _classCallCheck(this, Profile);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Profile).call(this, props));\n\n    _this.dictToArray = function (dict) {\n      var newArray = [];\n\n      for (var key in dict) {\n        newArray.push(dict[key]);\n      }\n\n      return newArray;\n    };\n\n    _this.addInput = function (name) {\n      // append empty string to end of array\n      _this.setState(_defineProperty({}, name, [].concat(_toConsumableArray(_this.state[name].slice()), [''])));\n    };\n\n    _this.removeInput = function (index, inputs, name) {\n      var newInputs = inputs.slice();\n      delete newInputs[index];\n\n      _this.setState(_defineProperty({}, name, _this.dictToArray(newInputs)));\n    };\n\n    _this.editInput = function (index, value, inputs, name) {\n      inputs[index] = value;\n\n      _this.setState(_defineProperty({}, name, _this.dictToArray(inputs)));\n    };\n\n    _this.assignSettings = function () {\n      var _this$props = _this.props,\n          school = _this$props.school,\n          updateSettings = _this$props.updateSettings;\n      var _this$state = _this.state,\n          settings = _this$state.settings,\n          name = _this$state.name;\n      var college_to_dorm = settings.college_to_dorm,\n          email_to_college = settings.email_to_college,\n          names = settings.names;\n\n      var emails = _this.state.emails.filter(function (email) {\n        return email !== '';\n      });\n\n      var dorms = _this.state.dorms.filter(function (dorm) {\n        return dorm !== '';\n      }); // reject this school's emails to override\n\n\n      var emailsDict = Object.keys(email_to_college).reduce(function (map, email) {\n        if (email_to_college[email] !== school) {\n          map[email] = email_to_college[email];\n        }\n\n        return map;\n      }, {});\n      emailsDict = emails.reduce(function (map, email) {\n        map[email] = school;\n        return map;\n      }, emailsDict);\n\n      var newSettings = _objectSpread({}, settings, {\n        college_to_dorm: _objectSpread({}, college_to_dorm, _defineProperty({}, school, dorms)),\n        email_to_college: emailsDict,\n        names: _objectSpread({}, names, _defineProperty({}, school, name))\n      });\n\n      updateSettings(newSettings);\n      alert('Config saved!');\n    };\n\n    _this.onNameInputChange = function (e) {\n      return _this.setState({\n        name: e.target.value\n      });\n    };\n\n    _this.state = {\n      loading: true\n    };\n    return _this;\n  }\n\n  _createClass(Profile, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      var _this$props2 = this.props,\n          school = _this$props2.school,\n          settings = _this$props2.settings;\n\n      if (isLoaded(settings) && this.state.loading) {\n        var college_to_dorm = settings.college_to_dorm,\n            email_to_college = settings.email_to_college,\n            names = settings.names;\n        this.setState({\n          dorms: college_to_dorm[school] || [],\n          emails: Object.keys(email_to_college).filter(function (email) {\n            return email_to_college[email] === school;\n          }) || [],\n          loading: false,\n          name: names[school] || '',\n          settings: settings\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state2 = this.state,\n          dorms = _this$state2.dorms,\n          emails = _this$state2.emails,\n          loading = _this$state2.loading,\n          name = _this$state2.name;\n\n      if (loading) {\n        return jsx(\"div\", {\n          style: {\n            height: 200\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 183\n          },\n          __self: this\n        }, jsx(Loading, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 184\n          },\n          __self: this\n        }));\n      }\n\n      return jsx(\"div\", {\n        css: profileStyle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190\n        },\n        __self: this\n      }, jsx(Header, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, \"SCHOOL\"), jsx(\"p\", {\n        className: \"nodescription\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }, \"Informal School Name (e.g. Harvard)\"), jsx(Input, {\n        className: \"input\",\n        handleInputChange: this.onNameInputChange,\n        placeholder: \"Name\",\n        type: \"text\",\n        value: name,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }), jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }), jsx(\"p\", {\n        className: \"nodescription\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }, \"Valid Email Suffix\"), jsx(InputList, {\n        addInput: this.addInput,\n        editInput: this.editInput,\n        inputs: emails,\n        name: \"emails\",\n        removeInput: this.removeInput,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }), jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }), jsx(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }, \"Dorms\"), jsx(\"div\", {\n        className: \"description\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, \"Add your dorm names here!\"), jsx(InputList, {\n        addInput: this.addInput,\n        editInput: this.editInput,\n        inputs: dorms,\n        name: \"dorms\",\n        removeInput: this.removeInput,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }), jsx(\"button\", {\n        className: \"savechanges\",\n        onClick: this.assignSettings,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }, jsx(\"i\", {\n        className: \"fas fa-check checkmark\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }), \"Save Changes\"));\n    }\n  }]);\n\n  return Profile;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state, props) {\n  return {\n    settings: state.firestore.data.config,\n    updateSettings: function updateSettings(settings) {\n      props.firestore.update({\n        collection: 'settings',\n        doc: 'config'\n      }, settings);\n    }\n  };\n};\n\nexport default compose(firebaseConnect(), firestoreConnect(function () {\n  return [{\n    collection: 'settings',\n    doc: 'config',\n    storeAs: 'config'\n  }];\n}), connect(mapStateToProps))(Profile);","map":{"version":3,"sources":["/Users/melissa/datamatch/src/pages/SchoolPortal/Profile.js"],"names":["Component","jsx","css","Header","connect","compose","firestoreConnect","firebaseConnect","isLoaded","Input","Loading","InputList","profileStyle","Profile","props","dictToArray","dict","newArray","key","push","addInput","name","setState","state","slice","removeInput","index","inputs","newInputs","editInput","value","assignSettings","school","updateSettings","settings","college_to_dorm","email_to_college","names","emails","filter","email","dorms","dorm","emailsDict","Object","keys","reduce","map","newSettings","alert","onNameInputChange","e","target","loading","height","mapStateToProps","firestore","data","config","update","collection","doc","storeAs"],"mappings":"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","sourcesContent":["/** @jsx jsx */\n\nimport { Component } from 'react';\nimport { jsx, css } from '@emotion/core';\nimport Header from 'components/Header';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport {\n  firestoreConnect,\n  firebaseConnect,\n  isLoaded,\n} from 'react-redux-firebase';\n\nimport Input from 'components/Input';\nimport Loading from 'components/Loading';\nimport InputList from './InputList';\n\nconst profileStyle = css`\n  p {\n    font-size: 18px;\n    font-family: Apercu;\n    font-weight: 500;\n    line-height: 22px;\n    letter-spacing: 0.05em;\n  }\n\n  .nodescription {\n    margin-bottom: 10px;\n  }\n\n  .description {\n    font-size: 16px;\n    font-family: Apercu-light;\n    margin-bottom: 10px;\n  }\n\n  .inputcontainer {\n    display: table;\n  }\n\n  .input {\n    width: 300px;\n    height: 40px;\n    background: #f4f2f2;\n    border: 0px;\n    margin-bottom: 5px;\n    margin-right: 10px;\n  }\n\n  .buttonsymbol {\n    line-height: 29px;\n  }\n\n  .roundbutton {\n    height: 35px;\n    width: 35px;\n    border: 3px solid #bd574e;\n    border-radius: 50%;\n    display: inline-block;\n    background: rgba(249, 198, 195, 0.8);\n    color: #bd574e;\n    text-align: center;\n    vertical-align: middle;\n    cursor: pointer;\n  }\n\n  .savechanges {\n    background: #bd574e;\n    color: #ffffff;\n    font-family: Apercu;\n    font-size: 18px;\n    width: 170px;\n    height: 38px;\n    letter-spacing: 0.05em;\n    align-items: center;\n    margin-top: 20px;\n  }\n\n  .checkmark {\n    margin-right: 4px;\n  }\n`;\n\nclass Profile extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { loading: true };\n  }\n\n  componentDidUpdate() {\n    const { school, settings } = this.props;\n\n    if (isLoaded(settings) && this.state.loading) {\n      const { college_to_dorm, email_to_college, names } = settings;\n\n      this.setState({\n        dorms: college_to_dorm[school] || [],\n        emails:\n          Object.keys(email_to_college).filter(\n            email => email_to_college[email] === school,\n          ) || [],\n        loading: false,\n        name: names[school] || '',\n        settings,\n      });\n    }\n  }\n\n  dictToArray = dict => {\n    let newArray = [];\n    for (var key in dict) {\n      newArray.push(dict[key]);\n    }\n    return newArray;\n  };\n\n  addInput = name => {\n    // append empty string to end of array\n    this.setState({ [name]: [...this.state[name].slice(), ''] });\n  };\n\n  removeInput = (index, inputs, name) => {\n    const newInputs = inputs.slice();\n    delete newInputs[index];\n    this.setState({ [name]: this.dictToArray(newInputs) });\n  };\n\n  editInput = (index, value, inputs, name) => {\n    inputs[index] = value;\n    this.setState({ [name]: this.dictToArray(inputs) });\n  };\n\n  assignSettings = () => {\n    const { school, updateSettings } = this.props;\n    const { settings, name } = this.state;\n    const { college_to_dorm, email_to_college, names } = settings;\n\n    const emails = this.state.emails.filter(email => {\n      return email !== '';\n    });\n\n    const dorms = this.state.dorms.filter(dorm => {\n      return dorm !== '';\n    });\n\n    // reject this school's emails to override\n    let emailsDict = Object.keys(email_to_college).reduce((map, email) => {\n      if (email_to_college[email] !== school) {\n        map[email] = email_to_college[email];\n      }\n      return map;\n    }, {});\n\n    emailsDict = emails.reduce((map, email) => {\n      map[email] = school;\n      return map;\n    }, emailsDict);\n\n    let newSettings = {\n      ...settings,\n      college_to_dorm: {\n        ...college_to_dorm,\n        [school]: dorms,\n      },\n      email_to_college: emailsDict,\n      names: {\n        ...names,\n        [school]: name,\n      },\n    };\n\n    updateSettings(newSettings);\n    alert('Config saved!');\n  };\n\n  onNameInputChange = e => this.setState({ name: e.target.value });\n\n  render() {\n    const { dorms, emails, loading, name } = this.state;\n\n    if (loading) {\n      return (\n        <div style={{ height: 200 }}>\n          <Loading />\n        </div>\n      );\n    }\n\n    return (\n      <div css={profileStyle}>\n        <Header>SCHOOL</Header>\n        <p className=\"nodescription\">Informal School Name (e.g. Harvard)</p>\n        <Input\n          className=\"input\"\n          handleInputChange={this.onNameInputChange}\n          placeholder=\"Name\"\n          type=\"text\"\n          value={name}\n        />\n\n        <br />\n\n        <p className=\"nodescription\">Valid Email Suffix</p>\n        <InputList\n          addInput={this.addInput}\n          editInput={this.editInput}\n          inputs={emails}\n          name=\"emails\"\n          removeInput={this.removeInput}\n        />\n\n        <br />\n\n        <p>Dorms</p>\n        <div className=\"description\">Add your dorm names here!</div>\n        <InputList\n          addInput={this.addInput}\n          editInput={this.editInput}\n          inputs={dorms}\n          name=\"dorms\"\n          removeInput={this.removeInput}\n        />\n\n        <button className=\"savechanges\" onClick={this.assignSettings}>\n          <i className=\"fas fa-check checkmark\"></i>Save Changes\n        </button>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  return {\n    settings: state.firestore.data.config,\n    updateSettings: settings => {\n      props.firestore.update(\n        {\n          collection: 'settings',\n          doc: 'config',\n        },\n        settings,\n      );\n    },\n  };\n};\n\nexport default compose(\n  firebaseConnect(),\n  firestoreConnect(() => [\n    {\n      collection: 'settings',\n      doc: 'config',\n      storeAs: 'config',\n    },\n  ]),\n  connect(mapStateToProps),\n)(Profile);\n"]},"metadata":{},"sourceType":"module"}